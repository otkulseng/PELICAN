2024-05-31 00:41:06.107873: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-05-31 00:41:06.280864: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-05-31 00:41:06.836732: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-05-31 00:41:09.979072: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-05-31 00:41:27.882467: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:282] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
Running train
Model: "functional_1"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 32, 4)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ inner_product       │ [(None, 32, 32,   │          0 │ input_layer[0][0] │
│ (InnerProduct)      │ 1), (None, 32,    │            │                   │
│                     │ 32, 1)]           │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 32, 32, 2) │          4 │ inner_product[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 32, 32, 2) │          0 │ dense[0][0],      │
│                     │                   │            │ inner_product[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lineq2v2 (Lineq2v2) │ (None, 32, 32,    │          0 │ multiply[0][0]    │
│                     │ 23)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 32, 32, 3) │         72 │ lineq2v2[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply_1          │ (None, 32, 32, 3) │          0 │ dense_1[0][0],    │
│ (Multiply)          │                   │            │ inner_product[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lineq2v0 (Lineq2v0) │ (None, 6)         │          0 │ multiply_1[0][0]  │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 64)        │        448 │ lineq2v0[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_3 (Dense)     │ (None, 32)        │      2,080 │ dense_2[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_4 (Dense)     │ (None, 5)         │        165 │ dense_3[0][0]     │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 2,769 (10.82 KB)
 Trainable params: 2,769 (10.82 KB)
 Non-trainable params: 0 (0.00 B)
0epoch [00:00, ?epoch/s]  0%|          | 0/1000 [00:00<?, ?epoch/s]/cluster/home/okulseng/.local/lib64/python3.11/site-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:120: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.
  self._warn_if_super_not_called()
  0%|          | 1/1000 [09:58<166:12:41, 598.96s/epoch, accuracy=0.676, loss=0.902, lr=0.01, val_accuracy=0.687, val_loss=0.869, val_lr=0.01]  0%|          | 2/1000 [19:55<165:41:49, 597.70s/epoch, accuracy=0.694, loss=0.852, lr=0.01, val_accuracy=0.693, val_loss=0.854, val_lr=0.01]  0%|          | 3/1000 [29:49<165:00:49, 595.84s/epoch, accuracy=0.698, loss=0.842, lr=0.01, val_accuracy=0.702, val_loss=0.834, val_lr=0.01]  0%|          | 4/1000 [39:46<164:59:02, 596.33s/epoch, accuracy=0.7, loss=0.835, lr=0.01, val_accuracy=0.695, val_loss=0.84, val_lr=0.01]     0%|          | 5/1000 [49:36<164:11:21, 594.05s/epoch, accuracy=0.701, loss=0.831, lr=0.01, val_accuracy=0.703, val_loss=0.833, val_lr=0.01]  1%|          | 6/1000 [59:33<164:17:09, 595.00s/epoch, accuracy=0.703, loss=0.828, lr=0.01, val_accuracy=0.706, val_loss=0.821, val_lr=0.01]  1%|          | 7/1000 [1:10:30<169:43:58, 615.35s/epoch, accuracy=0.703, loss=0.825, lr=0.01, val_accuracy=0.705, val_loss=0.82, val_lr=0.01]  1%|          | 8/1000 [1:21:34<173:50:14, 630.86s/epoch, accuracy=0.704, loss=0.823, lr=0.01, val_accuracy=0.706, val_loss=0.821, val_lr=0.01]  1%|          | 9/1000 [1:32:22<175:08:02, 636.21s/epoch, accuracy=0.704, loss=0.821, lr=0.01, val_accuracy=0.703, val_loss=0.826, val_lr=0.01]  1%|          | 10/1000 [1:43:11<176:01:35, 640.10s/epoch, accuracy=0.705, loss=0.819, lr=0.01, val_accuracy=0.704, val_loss=0.824, val_lr=0.01]  1%|          | 11/1000 [1:54:13<177:42:45, 646.88s/epoch, accuracy=0.705, loss=0.817, lr=0.01, val_accuracy=0.705, val_loss=0.817, val_lr=0.01]  1%|          | 12/1000 [2:05:12<178:30:35, 650.44s/epoch, accuracy=0.706, loss=0.816, lr=0.01, val_accuracy=0.706, val_loss=0.817, val_lr=0.01]  1%|▏         | 13/1000 [2:15:38<176:19:26, 643.13s/epoch, accuracy=0.706, loss=0.815, lr=0.01, val_accuracy=0.707, val_loss=0.814, val_lr=0.01]  1%|▏         | 14/1000 [2:26:08<175:01:56, 639.06s/epoch, accuracy=0.706, loss=0.813, lr=0.01, val_accuracy=0.706, val_loss=0.816, val_lr=0.01]  2%|▏         | 15/1000 [2:36:31<173:34:11, 634.37s/epoch, accuracy=0.706, loss=0.813, lr=0.01, val_accuracy=0.707, val_loss=0.812, val_lr=0.01]  2%|▏         | 16/1000 [2:46:55<172:30:10, 631.11s/epoch, accuracy=0.707, loss=0.811, lr=0.01, val_accuracy=0.707, val_loss=0.817, val_lr=0.01]  2%|▏         | 17/1000 [2:57:46<174:01:15, 637.31s/epoch, accuracy=0.707, loss=0.811, lr=0.01, val_accuracy=0.708, val_loss=0.815, val_lr=0.01]  2%|▏         | 18/1000 [3:08:29<174:17:27, 638.95s/epoch, accuracy=0.708, loss=0.809, lr=0.01, val_accuracy=0.711, val_loss=0.806, val_lr=0.01]  2%|▏         | 19/1000 [3:19:26<175:35:20, 644.36s/epoch, accuracy=0.709, loss=0.807, lr=0.01, val_accuracy=0.712, val_loss=0.803, val_lr=0.01]  2%|▏         | 20/1000 [3:30:15<175:46:29, 645.70s/epoch, accuracy=0.71, loss=0.806, lr=0.01, val_accuracy=0.712, val_loss=0.803, val_lr=0.01]   2%|▏         | 21/1000 [3:41:13<176:37:37, 649.50s/epoch, accuracy=0.712, loss=0.802, lr=0.01, val_accuracy=0.706, val_loss=0.823, val_lr=0.01]  2%|▏         | 22/1000 [3:52:03<176:28:07, 649.58s/epoch, accuracy=0.712, loss=0.802, lr=0.01, val_accuracy=0.716, val_loss=0.796, val_lr=0.01]  2%|▏         | 23/1000 [4:03:04<177:11:54, 652.93s/epoch, accuracy=0.713, loss=0.801, lr=0.01, val_accuracy=0.712, val_loss=0.804, val_lr=0.01]  2%|▏         | 24/1000 [4:13:55<176:54:09, 652.51s/epoch, accuracy=0.714, loss=0.8, lr=0.01, val_accuracy=0.716, val_loss=0.797, val_lr=0.01]    2%|▎         | 25/1000 [4:24:55<177:15:10, 654.47s/epoch, accuracy=0.714, loss=0.799, lr=0.01, val_accuracy=0.716, val_loss=0.798, val_lr=0.01]  3%|▎         | 26/1000 [4:35:49<177:04:29, 654.49s/epoch, accuracy=0.715, loss=0.798, lr=0.01, val_accuracy=0.712, val_loss=0.805, val_lr=0.01]  3%|▎         | 27/1000 [4:46:47<177:10:57, 655.56s/epoch, accuracy=0.715, loss=0.797, lr=0.01, val_accuracy=0.715, val_loss=0.797, val_lr=0.01]  3%|▎         | 28/1000 [4:57:38<176:36:08, 654.08s/epoch, accuracy=0.715, loss=0.797, lr=0.01, val_accuracy=0.717, val_loss=0.794, val_lr=0.01]slurmstepd: error: *** JOB 61005866 ON eu-g5-042-1 CANCELLED AT 2024-05-31T05:41:25 DUE TO TIME LIMIT ***
