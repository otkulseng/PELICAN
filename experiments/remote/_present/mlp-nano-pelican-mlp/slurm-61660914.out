2024-06-08 17:28:32.975576: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-06-08 17:28:33.050671: I external/local_tsl/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2024-06-08 17:28:33.374386: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-08 17:28:35.769744: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2024-06-08 17:28:46.982684: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:282] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected


Running train for /cluster/home/okulseng/PELICAN/experiments/_present/mlp-nano-pelican-mlp/conf-pelican-1/config.yml


Model: "functional_1"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 32, 4)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ inner_product       │ [(None, 32, 32,   │          0 │ input_layer[0][0] │
│ (InnerProduct)      │ 1), (None, 32,    │            │                   │
│                     │ 32, 1)]           │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ diag_bias_dense     │ (None, 32, 32, 2) │          6 │ inner_product[0]… │
│ (DiagBiasDense)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ batch_normalization │ (None, 32, 32, 2) │          8 │ diag_bias_dense[… │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lineq2v2 (Lineq2v2) │ (None, 32, 32,    │          0 │ batch_normalizat… │
│                     │ 22)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ diag_bias_dense_1   │ (None, 32, 32, 3) │         72 │ lineq2v2[0][0]    │
│ (DiagBiasDense)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ multiply (Multiply) │ (None, 32, 32, 3) │          0 │ diag_bias_dense_… │
│                     │                   │            │ inner_product[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ batch_normalizatio… │ (None, 32, 32, 3) │         12 │ multiply[0][0]    │
│ (BatchNormalizatio… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ lineq2v0 (Lineq2v0) │ (None, 6)         │          0 │ batch_normalizat… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 5)         │         35 │ lineq2v0[0][0]    │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 133 (532.00 B)
 Trainable params: 123 (492.00 B)
 Non-trainable params: 10 (40.00 B)
0epoch [00:00, ?epoch/s]  0%|          | 0/1000 [00:00<?, ?epoch/s]/cluster/home/okulseng/.local/lib64/python3.11/site-packages/keras/src/trainers/data_adapters/py_dataset_adapter.py:120: UserWarning: Your `PyDataset` class should call `super().__init__(**kwargs)` in its constructor. `**kwargs` can include `workers`, `use_multiprocessing`, `max_queue_size`. Do not pass these arguments to `fit()`, as they will be ignored.
  self._warn_if_super_not_called()
  0%|          | 1/1000 [08:35<142:58:38, 515.23s/epoch, accuracy=0.547, loss=1.16, lr=0.002, val_accuracy=0.193, val_loss=8.59, val_lr=0.002]  0%|          | 2/1000 [17:07<142:16:39, 513.23s/epoch, accuracy=0.625, loss=1.03, lr=0.002, val_accuracy=0.193, val_loss=6.39, val_lr=0.002]  0%|          | 3/1000 [25:38<141:57:32, 512.59s/epoch, accuracy=0.63, loss=1.02, lr=0.002, val_accuracy=0.297, val_loss=4.48, val_lr=0.002]   0%|          | 4/1000 [34:10<141:41:28, 512.14s/epoch, accuracy=0.634, loss=1.01, lr=0.002, val_accuracy=0.266, val_loss=4.58, val_lr=0.002]  0%|          | 5/1000 [42:42<141:33:09, 512.15s/epoch, accuracy=0.635, loss=1.01, lr=0.002, val_accuracy=0.26, val_loss=4.37, val_lr=0.002]   1%|          | 6/1000 [51:14<141:21:56, 511.99s/epoch, accuracy=0.638, loss=1, lr=0.002, val_accuracy=0.285, val_loss=3.35, val_lr=0.002]    1%|          | 7/1000 [59:46<141:17:43, 512.25s/epoch, accuracy=0.637, loss=1, lr=0.002, val_accuracy=0.377, val_loss=1.9, val_lr=0.002]   1%|          | 8/1000 [1:08:20<141:15:27, 512.63s/epoch, accuracy=0.646, loss=0.991, lr=0.002, val_accuracy=0.336, val_loss=2.4, val_lr=0.002]  1%|          | 9/1000 [1:16:53<141:10:38, 512.85s/epoch, accuracy=0.646, loss=0.99, lr=0.002, val_accuracy=0.617, val_loss=1.07, val_lr=0.002]  1%|          | 10/1000 [1:25:26<141:00:20, 512.75s/epoch, accuracy=0.632, loss=1.01, lr=0.002, val_accuracy=0.351, val_loss=1.75, val_lr=0.002]  1%|          | 11/1000 [1:34:03<141:12:29, 514.00s/epoch, accuracy=0.646, loss=0.989, lr=0.002, val_accuracy=0.661, val_loss=0.972, val_lr=0.002]  1%|          | 12/1000 [1:42:40<141:20:45, 515.03s/epoch, accuracy=0.659, loss=0.97, lr=0.002, val_accuracy=0.357, val_loss=1.9, val_lr=0.002]     1%|▏         | 13/1000 [1:51:14<141:07:06, 514.72s/epoch, accuracy=0.657, loss=0.969, lr=0.002, val_accuracy=0.33, val_loss=2.5, val_lr=0.002]  1%|▏         | 14/1000 [1:59:48<140:57:15, 514.64s/epoch, accuracy=0.656, loss=0.969, lr=0.002, val_accuracy=0.278, val_loss=2.57, val_lr=0.002]  2%|▏         | 15/1000 [2:08:23<140:46:18, 514.50s/epoch, accuracy=0.668, loss=0.95, lr=0.002, val_accuracy=0.437, val_loss=1.66, val_lr=0.002]   2%|▏         | 16/1000 [2:16:57<140:35:27, 514.36s/epoch, accuracy=0.667, loss=0.949, lr=0.002, val_accuracy=0.674, val_loss=0.946, val_lr=0.002]  2%|▏         | 17/1000 [2:25:30<140:20:33, 513.97s/epoch, accuracy=0.664, loss=0.949, lr=0.002, val_accuracy=0.509, val_loss=1.22, val_lr=0.002]   2%|▏         | 18/1000 [2:34:06<140:23:27, 514.67s/epoch, accuracy=0.664, loss=0.948, lr=0.002, val_accuracy=0.315, val_loss=1.8, val_lr=0.002]   2%|▏         | 19/1000 [2:42:46<140:39:15, 516.16s/epoch, accuracy=0.662, loss=0.949, lr=0.002, val_accuracy=0.343, val_loss=1.97, val_lr=0.002]  2%|▏         | 20/1000 [2:51:31<141:15:20, 518.90s/epoch, accuracy=0.66, loss=0.951, lr=0.002, val_accuracy=0.666, val_loss=0.945, val_lr=0.002]  2%|▏         | 21/1000 [3:00:20<141:58:41, 522.09s/epoch, accuracy=0.661, loss=0.948, lr=0.002, val_accuracy=0.67, val_loss=0.94, val_lr=0.002]   2%|▏         | 22/1000 [3:09:11<142:29:06, 524.49s/epoch, accuracy=0.663, loss=0.944, lr=0.002, val_accuracy=0.669, val_loss=0.934, val_lr=0.002]  2%|▏         | 23/1000 [3:17:58<142:34:48, 525.37s/epoch, accuracy=0.666, loss=0.938, lr=0.002, val_accuracy=0.439, val_loss=1.44, val_lr=0.002]   2%|▏         | 24/1000 [3:26:55<143:21:29, 528.78s/epoch, accuracy=0.664, loss=0.94, lr=0.002, val_accuracy=0.4, val_loss=1.49, val_lr=0.002]     2%|▎         | 25/1000 [3:35:39<142:50:03, 527.39s/epoch, accuracy=0.662, loss=0.943, lr=0.002, val_accuracy=0.256, val_loss=2.59, val_lr=0.002]  3%|▎         | 26/1000 [3:44:25<142:32:56, 526.87s/epoch, accuracy=0.663, loss=0.941, lr=0.002, val_accuracy=0.664, val_loss=0.941, val_lr=0.002]  3%|▎         | 27/1000 [3:53:03<141:43:09, 524.35s/epoch, accuracy=0.674, loss=0.92, lr=0.0002, val_accuracy=0.679, val_loss=0.913, val_lr=0.0002]  3%|▎         | 28/1000 [4:01:40<140:57:47, 522.09s/epoch, accuracy=0.675, loss=0.919, lr=0.0002, val_accuracy=0.676, val_loss=0.918, val_lr=0.0002]  3%|▎         | 29/1000 [4:10:17<140:25:24, 520.62s/epoch, accuracy=0.674, loss=0.919, lr=0.0002, val_accuracy=0.61, val_loss=1.01, val_lr=0.0002]    3%|▎         | 30/1000 [4:18:55<140:03:06, 519.78s/epoch, accuracy=0.675, loss=0.918, lr=0.0002, val_accuracy=0.679, val_loss=0.912, val_lr=0.0002]  3%|▎         | 31/1000 [4:27:30<139:30:15, 518.28s/epoch, accuracy=0.674, loss=0.918, lr=0.0002, val_accuracy=0.677, val_loss=0.917, val_lr=0.0002]  3%|▎         | 32/1000 [4:36:05<139:05:38, 517.29s/epoch, accuracy=0.674, loss=0.918, lr=0.0002, val_accuracy=0.673, val_loss=0.921, val_lr=0.0002]  3%|▎         | 33/1000 [4:44:40<138:47:02, 516.67s/epoch, accuracy=0.675, loss=0.917, lr=0.0002, val_accuracy=0.668, val_loss=0.932, val_lr=0.0002]  3%|▎         | 34/1000 [4:53:16<138:37:47, 516.63s/epoch, accuracy=0.676, loss=0.915, lr=0.0002, val_accuracy=0.599, val_loss=1.04, val_lr=0.0002]   4%|▎         | 35/1000 [5:01:55<138:38:57, 517.24s/epoch, accuracy=0.674, loss=0.919, lr=0.0002, val_accuracy=0.677, val_loss=0.915, val_lr=0.0002]  4%|▎         | 36/1000 [5:10:32<138:30:46, 517.27s/epoch, accuracy=0.675, loss=0.916, lr=0.0002, val_accuracy=0.668, val_loss=0.928, val_lr=0.0002]  4%|▎         | 37/1000 [5:19:10<138:25:38, 517.49s/epoch, accuracy=0.674, loss=0.918, lr=0.0002, val_accuracy=0.674, val_loss=0.919, val_lr=0.0002]  4%|▍         | 38/1000 [5:27:46<138:09:15, 517.00s/epoch, accuracy=0.676, loss=0.914, lr=2e-5, val_accuracy=0.678, val_loss=0.914, val_lr=2e-5]      4%|▍         | 39/1000 [5:36:20<137:45:44, 516.07s/epoch, accuracy=0.677, loss=0.914, lr=2e-5, val_accuracy=0.678, val_loss=0.913, val_lr=2e-5]  4%|▍         | 40/1000 [5:44:52<137:19:02, 514.94s/epoch, accuracy=0.677, loss=0.913, lr=2e-5, val_accuracy=0.678, val_loss=0.913, val_lr=2e-5]  4%|▍         | 41/1000 [5:53:23<136:51:44, 513.77s/epoch, accuracy=0.677, loss=0.912, lr=2e-5, val_accuracy=0.678, val_loss=0.912, val_lr=2e-5]  4%|▍         | 42/1000 [6:01:50<136:07:53, 511.56s/epoch, accuracy=0.678, loss=0.912, lr=2e-5, val_accuracy=0.679, val_loss=0.912, val_lr=2e-5]  4%|▍         | 43/1000 [6:10:11<135:08:45, 508.39s/epoch, accuracy=0.678, loss=0.911, lr=2e-5, val_accuracy=0.679, val_loss=0.911, val_lr=2e-5]  4%|▍         | 44/1000 [6:18:35<134:41:10, 507.19s/epoch, accuracy=0.678, loss=0.911, lr=2e-5, val_accuracy=0.679, val_loss=0.911, val_lr=2e-5]  4%|▍         | 45/1000 [6:26:56<134:01:36, 505.23s/epoch, accuracy=0.678, loss=0.911, lr=2e-5, val_accuracy=0.679, val_loss=0.911, val_lr=2e-5]  5%|▍         | 46/1000 [6:35:19<133:41:56, 504.52s/epoch, accuracy=0.678, loss=0.91, lr=2e-5, val_accuracy=0.679, val_loss=0.911, val_lr=2e-5]   5%|▍         | 47/1000 [6:43:42<133:27:17, 504.13s/epoch, accuracy=0.679, loss=0.91, lr=2e-5, val_accuracy=0.68, val_loss=0.91, val_lr=2e-5]    5%|▍         | 48/1000 [6:52:10<133:39:12, 505.41s/epoch, accuracy=0.679, loss=0.91, lr=2e-5, val_accuracy=0.68, val_loss=0.91, val_lr=2e-5]  5%|▍         | 49/1000 [7:00:35<133:27:55, 505.23s/epoch, accuracy=0.679, loss=0.91, lr=2e-5, val_accuracy=0.68, val_loss=0.91, val_lr=2e-5]  5%|▌         | 50/1000 [7:09:02<133:29:15, 505.85s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  5%|▌         | 51/1000 [7:17:25<133:05:11, 504.86s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  5%|▌         | 52/1000 [7:25:49<132:52:31, 504.59s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  5%|▌         | 53/1000 [7:34:12<132:38:18, 504.22s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  5%|▌         | 54/1000 [7:42:32<132:07:18, 502.79s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  6%|▌         | 55/1000 [7:50:50<131:35:14, 501.29s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.91, val_lr=2e-5]   6%|▌         | 56/1000 [7:59:03<130:51:53, 499.06s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  6%|▌         | 57/1000 [8:07:16<130:15:10, 497.25s/epoch, accuracy=0.679, loss=0.909, lr=2e-5, val_accuracy=0.681, val_loss=0.909, val_lr=2e-5]  6%|▌         | 58/1000 [8:15:18<128:55:01, 492.68s/epoch, accuracy=0.679, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  6%|▌         | 59/1000 [8:23:42<129:39:35, 496.04s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.908, val_lr=2e-5]    6%|▌         | 60/1000 [8:31:48<128:42:23, 492.92s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.908, val_lr=2e-5]  6%|▌         | 61/1000 [8:40:08<129:05:38, 494.93s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  6%|▌         | 62/1000 [8:48:27<129:18:28, 496.28s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  6%|▋         | 63/1000 [8:56:12<126:41:11, 486.74s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.908, val_lr=2e-5]   6%|▋         | 64/1000 [9:03:45<123:59:38, 476.90s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  6%|▋         | 65/1000 [9:11:17<121:50:54, 469.15s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]   7%|▋         | 66/1000 [9:18:47<120:14:11, 463.44s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  7%|▋         | 67/1000 [9:26:16<119:00:35, 459.20s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.908, val_lr=2e-5]   7%|▋         | 68/1000 [9:33:45<118:04:38, 456.09s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.68, val_loss=0.909, val_lr=2e-5]  7%|▋         | 69/1000 [9:41:17<117:39:34, 454.97s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  7%|▋         | 70/1000 [9:49:00<118:09:44, 457.40s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]  7%|▋         | 71/1000 [9:56:42<118:22:27, 458.72s/epoch, accuracy=0.68, loss=0.908, lr=2e-5, val_accuracy=0.681, val_loss=0.908, val_lr=2e-5]slurmstepd: error: *** JOB 61660914 ON eu-g5-045-3 CANCELLED AT 2024-06-09T03:28:36 DUE TO TIME LIMIT ***
